<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡¶∏‡¶æ‡¶ï‡¶ø‡¶¨ ‡¶è‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶ú</title>
  <style>
    
    /* Body Style */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f9f9f9;
    color: #333;
    width: 420px;
}

/* Navbar Style */
.navbar {
    display: flex;
    justify-content: left;
    align-items: left;
    padding: 10px;
    background-color: #9F2B68;
    color: white;
    height: 30px;
    gap: 3px;
    width: px;
    overflow: auto;
}
.navbar::-webkit-scrollbar {
        display: none;  /* ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤ ‡¶¨‡¶æ‡¶∞ ‡¶π‡¶æ‡¶á‡¶° ‡¶π‡ßü‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá */
    }

/* Navbar Input Style */
.navbar input {
    border-radius: 5px;
    font-size: 16px;
    height: 25px;
    width: 150px;
} 

.navbar label {
  white-space: nowrap;
  margin-top: 7px;
  margin-left: -70px;
  color: black;
  font-size: 14px;
  font-weight: bold;
  margin-right: 5px;
}
#orderDate {
  padding-left: 10px;
}
    
/* üîπ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶á‡¶®‡¶æ‡¶∞ */
#tabliContainer {
    max-width: 100%;
    overflow-x: auto;
    margin-top: 5px;
    border: 1px solid #ddd;
}

/* üîπ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤‡ßá‡¶∞ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶â‡¶ö‡ßç‡¶ö‡¶§‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ (‡ß´‡ß¶‡ß¶px ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤ ‡¶π‡¶¨‡ßá) */
.table-wrapper {
    max-height: 500px;
    overflow-y: auto;
    display: block;
}

/* üîπ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
.product-table {
    width: 100%;
    border-collapse: collapse;
    text-align: center;
    table-layout: fixed;
    
}

/* üîπ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤‡ßá‡¶∞ ‡¶π‡ßá‡¶°‡¶æ‡¶∞ (‡¶∏‡ßç‡¶ü‡¶ø‡¶ï‡¶ø ‡¶ï‡¶∞‡¶¨‡ßá) */
.product-table thead {
    position: sticky;
    top: 0;
    background: #007bff;
    color: white;
    z-index: 2;
}
.product-table th {
  border: 1px solid white;
  height: 30px;
}
.product-table td {
  border: 1px solid black;
  height: 30px;
}

/* üîπ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶π‡ßá‡¶°‡¶æ‡¶∞ (th) ‡¶∏‡¶æ‡¶á‡¶ú ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ */
.product-table th:nth-child(1),
.product-table td:nth-child(1) {
    width: 50px;
    min-width: 50px;
    max-width: 50px;
    font-size: 18px;
}

.product-table th:nth-child(2),
.product-table td:nth-child(2) {
    width: 250px;
    min-width: 250px;
    max-width: 250px;
    font-size: 18px;
}

.product-table th:nth-child(6),
.product-table td:nth-child(6) {
    width: 60px;
    min-width: 60px;
    max-width: 60px;
    font-size: 18px;
}
.product-table th:nth-child(9),
.product-table td:nth-child(9),
.product-table th:nth-child(10),
.product-table td:nth-child(10) {
    width: 60px;
    min-width: 60px;
    max-width: 60px;
    font-size: 16px;
}

.product-table th:last-child,
.product-table td:last-child {
    width: 100px;
    min-width: 100px;
    max-width: 100px;
    font-size: 18px;
}

/* üîπ ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶∏‡¶¨ th ‡¶ì td ‡¶è‡¶∞ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶• ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ */
.product-table th:not(:nth-child(1)):not(:nth-child(2)):not(:nth-child(6)):not(:last-child):not(:nth-child(9)):not(:nth-child(10)),
.product-table td:not(:nth-child(1)):not(:nth-child(2)):not(:nth-child(6)):not(:last-child):not(:nth-child(9)):not(:nth-child(10)) {
    width: 100px;
    min-width: 100px;
    max-width: 100px;
    font-size: 18px;
}

/* üîπ ‡¶Æ‡ßã‡¶ü ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶ì‡ßü‡¶æ ‡¶∞‡ßã (‡¶™‡ßç‡¶∞‡¶§‡¶ø td ‡¶è‡¶∞ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶• ‡ßß‡ß´‡ß¶px) */
.product-table tfoot td {
    width: 200px !important;
    min-width: 200px !important;
    max-width: 200px !important;
    font-weight: bold;
    background: #f8f9fa;
    font-size: 18px;
}

/* üîπ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® (‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡¶æ) */
.product-table input {
    width: 100%;
    height: 100%;
    border: none;
    background: none;
    text-align: center;
    padding: 0;
    outline: none;
    font-size: 18px;
}
#tabliContainer h3 {
  margin: 0px;
  text-align: center;
  padding: 5px;
  font-size: 20px;
}
.placeholder-container {
    position: relative;
    display: flex;
    align-items: center;
    width: 100%;
    border: 1px solid #ccc;
    padding: 5px;
    box-sizing: border-box;
}

.placeholder-container label {
    position: absolute;
    left: 10px;
    white-space: nowrap;
    color: gray;
    transition: 0.3s ease-in-out;
}

.placeholder-container input {
    width: 100%;
    border: none;
    outline: none;
    background: transparent;
    padding-left: 60px; /* ‡¶™‡ßç‡¶≤‡ßá‡¶∏‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡¶∞ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶¨‡ßá */
    font-size: 16px;
}

.placeholder-container input:focus + label,
.placeholder-container input:not(:placeholder-shown) + label {
    left: 5px; /* ‡¶≤‡ßá‡¶¨‡ßá‡¶≤ ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶¨‡¶æ‡¶Æ‡ßá ‡¶∏‡¶∞‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá */
    color: black;
}
.eql {
  width: 100%;
  height: 100%;
  
}


/* Footer Style */
.footer-container {
    background-color: #E2DFD2;
    height: 60px;
    width: 420px;
    display: flex;
}

/* Footer Textarea */
#notes {
    padding: 10px;
    width: 200px;
    margin-left: 10px;
    margin-top: 4px;
}

/* Footer Buttons */
.footer-buttons {
    display: flex;
    align-items: center;
    justify-content: space-around;
    margin-left: 10px;
}

.footer-buttons button {
    margin: 5px;
    padding: 10px 10px 10px 10px;
    border-radius: 50%;
    background-color: #0818A8;
    color: white;
    font-size: 16px;
    border: 2px solid #0818A8;
}


  </style>
</head>
<body>
  
      <!-- ‡¶®‡ßá‡¶≠‡¶¨‡¶æ‡¶∞ -->
    <div class="navbar">
        <input type="text" id="roadName" placeholder="‡¶∞‡ßã‡¶°">
       <input type="text" id="dsr-name" placeholder="‡¶°‡¶ø‡¶è‡¶∏‡¶æ‡¶∞" readonly>
       <input type="date" id="orderDate">
        <input type="number" id="totalSell"  readonly="">
        <label for="totalSell">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø </label>
        <input type="number" id="joma">
        <label for="joma">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶ú‡¶Æ‡¶æ</label>
        <input type="number" id="dueAmount" readonly>
        <label for="dueAmount">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡¶æ‡¶ï‡¶ø</label>
    </div>

           
        <!-- ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ -->
    <div class="table-container" id="tabliContainer">
      <table id="mainTable" class="product-table">
    <thead>
        <tr>
            <th>‡¶®‡¶Ç</th>
            <th>‡¶™‡ßç‡¶∞‡¶°‡¶æ‡¶ï‡ßç‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</th>
            <th>‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞</th>
            <th>‡¶´‡ßá‡¶∞‡¶§</th>
            <th>‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø</th>
            <th>‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø</th>
            <th>‡¶Æ‡ßã‡¶ü ‡¶∏‡ßá‡¶≤</th>
            <th>‡¶∏‡ßç‡¶ü‡¶ï</th>
            <th>‡¶°‡ßá‡¶Æ‡ßá‡¶ú</th>
            <th>‡¶°‡ßá‡¶Æ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø</th>
        </tr>
      </thead>
    </table>
    
          <!-- ‡¶´‡ßÅ‡¶ü‡¶æ‡¶∞ -->
    <footer class="footer-container">
        <div class="footer-textarea">
            <textarea id="notes" placeholder="‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." maxlength="250"></textarea>
        </div>

        <div class="footer-buttons">
          
            <button id="draftButton" class="draft-btn" onclick="loadDrafts()">‡¶ö‡ßá‡¶ï</button>
             
        </div>
    </footer>
       
    </div>
     
<!-- ‡¶™‡¶™‡¶Ü‡¶™ ‡¶°‡¶ø‡¶≠ -->
<div id="draftPopup" style="display: none; position: fixed; top: 20%; left: 50%; transform: translateX(-50%); background: white; padding: 20px; border: 1px solid #ccc; box-shadow: 0 4px 8px rgba(0,0,0,0.1); max-height: 400px; overflow-y: auto;">
    <h3>‡¶°‡ßç‡¶∞‡¶æ‡¶´‡ßç‡¶ü ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
    <ul id="draftList"> </ul>
    <button onclick="closeDraftPopup()">‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>
    
<script type="module">
// ‚úÖ Firebase.js ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡ßÄ‡ßü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶á‡¶Æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
import { db, auth } from "./firebase.js";
import { 
    collection, 
    getDocs, 
    doc, 
    getDoc 
} from "https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js";
import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-auth.js";

// --------------------------------------------------------------------
// ‚úÖ **‡¶°‡ßç‡¶∞‡¶æ‡¶´‡ßç‡¶ü ‡¶™‡¶™‡¶Ü‡¶™ ‡¶ñ‡ßÅ‡¶≤‡ßÅ‡¶® (Offline Mode ‡¶∏‡¶π)**
window.loadDrafts = async function () {
    const draftPopup = document.getElementById("draftPopup");
    const draftList = document.getElementById("draftList");
    draftList.innerHTML = ""; // ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶¨‡ßá

    try {
        // üîπ Firestore ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶´‡ßá‡¶ö ‡¶ï‡¶∞‡¶¨‡ßá ‡¶Ø‡¶¶‡¶ø ‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶Ö‡¶´ ‡¶•‡¶æ‡¶ï‡ßá
        const querySnapshot = await getDocs(collection(db, "History"), navigator.onLine ? {} : { source: "cache" });

        let hasDrafts = false;
        const uniqueDrafts = new Set(); // üîπ ‡¶°‡ßÅ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶ü ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

        querySnapshot.forEach((docSnap) => {
            const data = docSnap.data();
            if (data.status === "Complete") { // üîπ ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ Incomplete ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
                const textContent = `${data.dsrName} - ${data.orderDate}`;
                if (!uniqueDrafts.has(textContent)) {
                    uniqueDrafts.add(textContent);
                    hasDrafts = true;
                    const li = document.createElement("li");
                    li.textContent = textContent;
                    li.dataset.docId = docSnap.id;
                    li.onclick = function () {
                        loadDraftData(docSnap.id);
                        draftPopup.style.display = "none";
                    };
                    draftList.appendChild(li);
                }
            }
        });

        if (!hasDrafts) {
            alert("‡¶ï‡ßã‡¶®‡ßã Complete ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø!");
            return;
        }
        draftPopup.style.display = "block";
    } catch (error) {
        console.error("‡¶°‡ßç‡¶∞‡¶æ‡¶´‡ßç‡¶ü ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ:", error);
        alert("‡¶°‡ßç‡¶∞‡¶æ‡¶´‡ßç‡¶ü ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ: " + error.message);
    }
};

// --------------------------------------------------------------------
// ‚úÖ **‡¶°‡ßç‡¶∞‡¶æ‡¶´‡ßç‡¶ü ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶® (Offline Mode ‡¶∏‡¶π)**
async function loadDraftData(docId) {
    try {
        const historyRef = doc(db, "History", docId);
        const historySnap = await getDoc(historyRef, navigator.onLine ? {} : { source: "cache" });

        if (!historySnap.exists()) {
            alert("‡¶°‡¶ï‡ßÅ‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø!");
            return;
        }

        const data = historySnap.data();
        const table = document.getElementById("mainTable");

        // ‚úÖ **‡¶®‡ßá‡¶≠‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá**
        document.getElementById("roadName").value = data.roadName || "";
        document.getElementById("dsr-name").value = data.dsrName || "";
        Object.assign(document.getElementById("orderDate"), { type: "text", value: data.orderDate || "" });
        document.getElementById("totalSell").value = data.totalSell || 0;
        document.getElementById("joma").value = data.joma || 0;
        document.getElementById("dueAmount").value = data.dueAmount || 0;
        document.getElementById("notes").value = data.notes || "";

        // ‚úÖ **Firestore ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ**
        const companyNames = Object.keys(data).filter(key => 
            !["roadName", "dsrName", "orderDate", "totalSell", "joma", "dueAmount", "status", "notes"].includes(key)
        );

        console.log("‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡ßü‡¶æ ‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ:", companyNames);

        for (const companyName of companyNames) {
            const products = data[companyName];
            let tbody = document.getElementById(companyName);
            if (tbody) {
                alert(`${companyName} ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶á‡¶§‡ßã‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∞‡ßü‡ßá‡¶õ‡ßá!`);
                continue;
            }

            // ‚úÖ **‡¶®‡¶§‡ßÅ‡¶® `tbody` ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá**
            tbody = document.createElement("tbody");
            tbody.id = companyName;
            const companyNameFm = companyName.replace(/_/g, " "); // "_" -> " " ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®

            // ‚úÖ **‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶∞‡ßã ‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá**
            const companyRow = document.createElement("tr");
            companyRow.innerHTML = `<td colspan="10"><strong>${companyNameFm}</strong></td>`;
            tbody.appendChild(companyRow);

            let lastRowData = null;
            products.forEach((productData) => {
                if (productData.rowName === "lastRow") {
                    lastRowData = productData;
                    return;
                }
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${productData.productNumber || ""}</td>
                    <td>${productData.productName || ""}</td>
                    <td><input type="text" placeholder="‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞" value="${productData.order || ""}"></td>
                    <td><input type="text" placeholder="‡¶´‡ßá‡¶∞‡¶§" value="${productData.returned || ""}"></td>
                    <td>${productData.sell || ""}</td>
                    <td>${productData.price || ""}</td>
                    <td>${productData.totalSell || ""}</td>
                    <td>${productData.stock || ""}</td>
                    <td><input type="text" placeholder="‡¶°‡ßá‡¶Æ‡ßá‡¶ú" value="${productData.damage || ""}"></td>
                    <td>${productData.damageCost || ""}</td>
                `;
                tbody.appendChild(row);
            });

            if (lastRowData) {
                const totalRow = document.createElement("tr");
                totalRow.innerHTML = `
                    <td colspan="2">
                        <div class="placeholder-container">
                            <label>‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶ø</label>
                            <input type="text" id="totalSellInput" placeholder=" " value="${lastRowData.totalSell || ""}">
                        </div>
                    </td>
                    <td colspan="2">
                        <div class="placeholder-container">
                            <label>‡¶Æ‡ßã‡¶ü ‡¶°‡ßá‡¶Æ‡ßá‡¶ú</label>
                            <input type="text" id="totalDamageInput" placeholder=" " value="${lastRowData.totalDamage || ""}">
                        </div>
                    </td>
                    <td colspan="2" id="motTaka">
                        <div class="placeholder-container">
                            <label>‡¶Æ‡ßã‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ</label>
                            <input type="text" id="totalAmountInput" placeholder=" " value="${lastRowData.totalAmount || ""}">
                        </div>
                    </td>
                `;
                tbody.appendChild(totalRow);
            }
            table.appendChild(tbody);
        }
        alert("‚úÖ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
    } catch (error) {
        console.error("‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ:", error);
        alert("‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ: " + error.message);
    }
}

// --------------------------------------------------------------------
// ‚úÖ **‡¶™‡¶™‡¶Ü‡¶™ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®**
window.closeDraftPopup = function () {
    document.getElementById("draftPopup").style.display = "none";
};

// --------------------------------------------------------------------
// ‚úÖ **Auth State ‡¶ö‡ßá‡¶ï (Offline Support ‡¶∏‡¶π)**
onAuthStateChanged(auth, (user) => {
    if (user) {
       console.log("User is logged in:", user.uid);
    } else {
        console.error("User not logged in. Redirecting to login page.");
        window.location.href = "login.html";
    }
});

</script>



 </body>